library(lubridate)
library(spdep)
library(ggplot2)
aphids <- read.xlsx ("dispersal_data_analysis.xlsx")
table(aphids$block, aphids$treatment)
table(aphids$block, aphids$replicate)
table(aphids$block, aphids$replicate, aphids$treatment)
aphids <- read.xlsx ("dispersal_data_analysis.xlsx")
table(aphids$block, aphids$replicate, aphids$treatment)
#should i have treatment, days_after_release and variety as factors?
aphids$treatmentfac <- as.factor(aphids$treatment)
aphids$day <- lubridate::as_date(aphids$day, origin="1899-12-30")
#aphids$days_after_releasefac <- as.factor(aphids$days_after_release)
#  why 'column_num' appears NA when using mutate function? "as.numeric"?
aphids <- aphids %>%
mutate(
column_num = as.numeric(factor(p_column, levels = letters[1:7])),
row_num = as.numeric(p_row)
)
table(aphids$treatmentfac, aphids$days_after.release)
table(aphids$treatmentfac)
aphid1 <- aphids[which(aphids$treatmentfac == "intercropping"),]
aphid2 <- aphids[which(aphids$treatmentfac == "mix"),]
aphid3 <- aphids[which(aphids$treatmentfac == "control w"),]
aphid4 <- aphids[which(aphids$treatmentfac == "control m") ,]
aphid1 <- aphid1[which(aphid1$days_after.release == 7),]
aphid2 <- aphid2[which(aphid2$days_after.release == 7),]
aphid3 <- aphid3[which(aphid3$days_after.release == 7),]
aphid4 <- aphid4[which(aphid4$days_after.release == 7) ,]
table(aphid1$replicate)
table(aphid1$block)
interp_result1 <- interp(
x = aphid1$column_num,
y = aphid1$row_num,
z = aphid1$no_nymphs,
linear = F  # Use linear interpolation; set to TRUE if you prefer linear interpolation
)
table(aphid1$block, aphid1$replicate)
interp_result1 <- interp(
x = aphid1$column_num,
y = aphid1$row_num,
z = aphid1$no_nymphs,
linear = F  # Use linear interpolation; set to TRUE if you prefer linear interpolation
)
aphid1$column_num
aphid1$row_num
aphid1$no_nymphs
aphid1[which(aphid1$block == 1 & aphid1$replicate==1),]
test <- aphid1[which(aphid1$block == 1 & aphid1$replicate==1),]
test1 <- interp(
x = test$column_num,
y = test$row_num,
z = test$no_nymphs,
linear = F  # Use linear interpolation; set to TRUE if you prefer linear interpolation
)
test1
setwd("D:/Dropbox/WORK/__Harper Adams/__STUDENTS/BSc/aimee hanif")
library(openxlsx)
ad <- read.xlsx("Questionnaire Download  2.xlsx", skip=1)
ad <- read.xlsx("Questionnaire Download  2.xlsx", skipEmptyRows = T)
ad <- read.xlsx("Questionnaire Download  2.xlsx", startrow = 2)
ad <- read.xlsx("Questionnaire Download  2.xlsx", startRow = 2)
ad[,12] # urban, rural
ad[,13] # urban, rural
table(ad[,13])
barplot(table(ad[,13]))
barplot(table(ad[,13]))
ad[,15] # urban, rural
table(ad[15])
barplot(table(ad[,15]))
table(ad[,13],ad[15])
table(ad[,13],ad[,15])
barplot(table(ad[,13],ad[,15])
)
barplot(table(ad[,13],ad[,15]), beside = T)
prop.table(ad[,13],ad[,15])
prop.table(table(ad[,13],ad[,15]))
round(prop.table(table(ad[,13],ad[,15])), 2)
barplot(table(ad[,13],ad[,15]), beside = T)
barplot(round(prop.table(table(ad[,13],ad[,15])), 2)
)
barplot(round(prop.table(table(ad[,13],ad[,15])), 2), beside = T
)
barplot(round(prop.table(table(ad[,13],ad[,15])), 2), beside = T,
ylab = "Proportion")
barplot(round(prop.table(table(ad[,13],ad[,15])), 2), beside = T,
ylab = "Proportion",
xlab = "Give your dog a supplement?")
legend(x = 1.2, y=.4, legend = c("Rural", "Urban"))
legend(x = 1.2, y=.4, legend = c("Rural", "Urban"),
pch = 15)
legend(x = 1.2, y=.4, legend = c("Rural", "Urban"),
pch = 15, col = c("gray20", "gray80"))
chisq.test(table(ad[,13],ad[,15]))
table(ad[,13],ad[,15])
ad[,15]
table(ad[,15])
chisq.test(table(ad[,13],ad[,15]))
library(akima)
library(dplyr)
library(openxlsx)
library(lubridate)
library(spdep)
library(ggplot2)
aphids <- read.xlsx ("dispersal_data_analysis.xlsx")
setwd("D:/Dropbox/WORK/__Harper Adams/__STUDENTS/PhD/Maria Damascena/2024-04-11")
aphids <- read.xlsx ("dispersal_data_analysis.xlsx")
table(aphids$block, aphids$replicate, aphids$treatment)
#should i have treatment, days_after_release and variety as factors?
aphids$treatmentfac <- as.factor(aphids$treatment)
aphids$day <- lubridate::as_date(aphids$day, origin="1899-12-30")
aphids <- aphids %>%
mutate(
column_num = as.numeric(factor(p_column, levels = letters[1:7])),
row_num = as.numeric(p_row)
)
table(aphids$treatmentfac, aphids$days_after.release)
table(aphids$treatmentfac)
aphids <- read.xlsx ("dispersal_data_analysis.xlsx")
table(aphids$block, aphids$replicate, aphids$treatment)
#should i have treatment, days_after_release and variety as factors?
aphids$treatmentfac <- as.factor(aphids$treatment)
aphids$day <- lubridate::as_date(aphids$day, origin="1899-12-30")
#aphids$days_after_releasefac <- as.factor(aphids$days_after_release)
#  why 'column_num' appears NA when using mutate function? "as.numeric"?
aphids <- aphids %>%
mutate(
column_num = as.numeric(factor(p_column, levels = letters[1:7])),
row_num = as.numeric(p_row)
)
table(aphids$treatmentfac, aphids$days_after.release)
table(aphids$treatmentfac)
aphid1 <- aphids[which(aphids$treatmentfac == "intercropping"),]
aphid2 <- aphids[which(aphids$treatmentfac == "mix"),]
aphid3 <- aphids[which(aphids$treatmentfac == "control w"),]
aphid4 <- aphids[which(aphids$treatmentfac == "control m") ,]
aphid1 <- aphid1[which(aphid1$days_after.release == 7),]
aphid2 <- aphid2[which(aphid2$days_after.release == 7),]
aphid3 <- aphid3[which(aphid3$days_after.release == 7),]
aphid4 <- aphid4[which(aphid4$days_after.release == 7),]
table(aphid1$block, aphid1$replicate)
test <- aphid1[which(aphid1$block == 1 & aphid1$replicate==1),]
test
interp_result2 <- interp(
x = aphid2$column_num,
y = aphid2$row_num,
z = aphid2$no_nymphs,
linear = F  # Use linear interpolation; set to TRUE if you prefer linear interpolation
)
interp_result2 <- interp(
x = aphid2$column_num,
y = aphid2$row_num,
z = aphid2$no_nymphs,
linear = F,  # Use linear interpolation; set to TRUE if you prefer linear interpolation
duplicate = "strip"
)
interp_result2 <- interp(
x = aphid2$column_num,
y = aphid2$row_num,
z = aphid2$no_nymphs,
linear = F,  # Use linear interpolation; set to TRUE if you prefer linear interpolation
duplicate = "mean"
)
test
test1 <- interp(
x = test$column_num,
y = test$row_num,
z = test$no_nymphs,
linear = T  # Use linear interpolation; set to TRUE if you prefer linear interpolation
)
test1
filled.contour(test1$x, test1$y, test1$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "Aphids heatmap",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
# global_z_min <- min(all_z_values, na.rm = T)
global_z_min <- -.01
global_z_max <- max(test1$z, na.rm = T)
filled.contour(test1$x, test1$y, test1$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "Aphids heatmap",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
test <- aphid1[which(aphid1$block == 1 & aphid1$replicate==2),]
test1 <- interp(
x = test$column_num,
y = test$row_num,
z = test$no_nymphs,
linear = T  # Use linear interpolation; set to TRUE if you prefer linear interpolation
)
filled.contour(test1$x, test1$y, test1$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "Aphids heatmap",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
test <- aphid1[which(aphid1$block == 1 & aphid1$replicate==3),]
test1 <- interp(
x = test$column_num,
y = test$row_num,
z = test$no_nymphs,
linear = T  # Use linear interpolation; set to TRUE if you prefer linear interpolation
)
filled.contour(test1$x, test1$y, test1$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "Aphids heatmap",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
global_z_max <- max(test1$z, na.rm = T)
filled.contour(test1$x, test1$y, test1$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "Aphids heatmap",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
interp_result2 <- interp(
x = aphid2$column_num,
y = aphid2$row_num,
z = aphid2$no_nymphs,
linear = F,  # Use linear interpolation; set to TRUE if you prefer linear interpolation
duplicate = "mean"
)
interp_result2 <- interp(
x = aphid2$column_num,
y = aphid2$row_num,
z = aphid2$no_nymphs,
linear = F,  # Use linear interpolation; set to TRUE if you prefer linear interpolation
duplicate = "mean"
)
global_z_max <- max(interp_result2$z, na.rm = T)
filled.contour(interp_result2$x, interp_result2$y, interp_result2$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "Aphids heatmap",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
aphids <- read.xlsx ("dispersal_data_analysis.xlsx")
aphids$treatmentfac <- as.factor(aphids$treatment)
aphids$day <- lubridate::as_date(aphids$day, origin="1899-12-30")
aphids <- aphids %>%
mutate(
column_num = as.numeric(factor(p_column, levels = letters[1:7])),
row_num = as.numeric(p_row)
)
aphid1 <- aphids[which(aphids$treatmentfac == "intercropping"),]
aphid2 <- aphids[which(aphids$treatmentfac == "mix"),]
aphid3 <- aphids[which(aphids$treatmentfac == "control w"),]
aphid4 <- aphids[which(aphids$treatmentfac == "control m") ,]
aphid1 <- aphid1[which(aphid1$days_after.release == 7),]
aphid2 <- aphid2[which(aphid2$days_after.release == 7),]
aphid3 <- aphid3[which(aphid3$days_after.release == 7),]
aphid4 <- aphid4[which(aphid4$days_after.release == 7),]
which(aphids$treatmentfac == "intercropping")
which(aphids$treatmentfac == "intercropping" &
aphid1$days_after.release == 7)
which(aphids$treatmentfac == "intercropping" &&
aphid1$days_after.release == 7)
aphids <- read.xlsx ("dispersal_data_analysis.xlsx")
aphids$treatmentfac <- as.factor(aphids$treatment)
aphids$day <- lubridate::as_date(aphids$day, origin="1899-12-30")
aphids <- aphids %>%
mutate(
column_num = as.numeric(factor(p_column, levels = letters[1:7])),
row_num = as.numeric(p_row)
)
intercropping <- aphids[which(aphids$treatmentfac == "intercropping"),]
mix <- aphids[which(aphids$treatmentfac == "mix"),]
controlw <- aphids[which(aphids$treatmentfac == "control w"),]
controlm <- aphids[which(aphids$treatmentfac == "control m") ,]
intercropping7 <- intercropping[which(intercropping$days_after.release == 7),]
mix7 <- mix[which(mix$days_after.release == 7),]
controlw7 <- controlw[which(controlw$days_after.release == 7),]
controlm7 <- controlm[which(controlm$days_after.release == 7),]
rm(aphids, intercropping, mix, controlw, controlm)
intercropping <- interp(
x = intercropping$column_num,
y = intercropping$row_num,
z = intercropping$no_nymphs,
linear = T,
duplicate = "mean"
)
intercropping7 <- interp(
x = intercropping7$column_num,
y = intercropping7$row_num,
z = intercropping7$no_nymphs,
linear = T,
duplicate = "mean"
)
intercropping7 <- interp(
x = intercropping7$column_num,
y = intercropping7$row_num,
z = intercropping7$no_nymphs,
linear = T,
duplicate = "mean"
)
intercropping7
## data setup ####
aphids <- read.xlsx ("dispersal_data_analysis.xlsx")
aphids$treatmentfac <- as.factor(aphids$treatment)
aphids$day <- lubridate::as_date(aphids$day, origin="1899-12-30")
aphids <- aphids %>%
mutate(
column_num = as.numeric(factor(p_column, levels = letters[1:7])),
row_num = as.numeric(p_row)
)
intercropping <- aphids[which(aphids$treatmentfac == "intercropping"),]
mix <- aphids[which(aphids$treatmentfac == "mix"),]
controlw <- aphids[which(aphids$treatmentfac == "control w"),]
controlm <- aphids[which(aphids$treatmentfac == "control m") ,]
intercropping7 <- intercropping[which(intercropping$days_after.release == 7),]
mix7 <- mix[which(mix$days_after.release == 7),]
controlw7 <- controlw[which(controlw$days_after.release == 7),]
controlm7 <- controlm[which(controlm$days_after.release == 7),]
rm(aphids, intercropping, mix, controlw, controlm)
intercropping7$column_num
intercropping7$row_num
intercropping7$no_nymphs
intercropping7 <- interp(
x = intercropping7$column_num,
y = intercropping7$row_num,
z = intercropping7$no_nymphs,
linear = T,
duplicate = "mean"
)
mix7$no_nymphs
mix7 <- interp(
x = mix7$column_num,
y = mix7$row_num,
z = mix7$no_nymphs,
linear = F,  # Use linear interpolation; set to TRUE if you prefer linear interpolation
duplicate = "mean"
)
controlw7 <- interp(
x = controlw7$column_num,
y = controlw7$row_num,
z = controlw7$no_nymphs,
linear = F  # Use linear interpolation; set to TRUE if you prefer linear interpolation
)
controlw7 <- interp(
x = controlw7$column_num,
y = controlw7$row_num,
z = controlw7$no_nymphs,
linear = F,
duplicate = "mean"
)
controlm7 <- interp(
x = controlm7$column_num,
y = controlm7$row_num,
z = controlm7$no_nymphs,
linear = F,
duplicate = "mean"
)
aphids <- aphids[!is.na(aphids$no_nymphs),]
## data setup ####
aphids <- read.xlsx ("dispersal_data_analysis.xlsx")
aphids <- aphids[!is.na(aphids$no_nymphs),]
## data setup ####
aphids <- read.xlsx ("dispersal_data_analysis.xlsx")
aphids <- aphids[!is.na(aphids$no_nymphs),]
aphids$treatmentfac <- as.factor(aphids$treatment)
aphids$day <- lubridate::as_date(aphids$day, origin="1899-12-30")
aphids <- aphids %>%
mutate(
column_num = as.numeric(factor(p_column, levels = letters[1:7])),
row_num = as.numeric(p_row)
)
intercropping <- aphids[which(aphids$treatmentfac == "intercropping"),]
mix <- aphids[which(aphids$treatmentfac == "mix"),]
controlw <- aphids[which(aphids$treatmentfac == "control w"),]
controlm <- aphids[which(aphids$treatmentfac == "control m") ,]
intercropping7 <- intercropping[which(intercropping$days_after.release == 7),]
mix7 <- mix[which(mix$days_after.release == 7),]
controlw7 <- controlw[which(controlw$days_after.release == 7),]
controlm7 <- controlm[which(controlm$days_after.release == 7),]
rm(aphids, intercropping, mix, controlw, controlm)
intercropping7 <- interp(
x = intercropping7$column_num,
y = intercropping7$row_num,
z = intercropping7$no_nymphs,
linear = T,
duplicate = "mean"
)
mix7 <- interp(
x = mix7$column_num,
y = mix7$row_num,
z = mix7$no_nymphs,
linear = F,
duplicate = "mean"
)
controlw7 <- interp(
x = controlw7$column_num,
y = controlw7$row_num,
z = controlw7$no_nymphs,
linear = F,
duplicate = "mean"
)
controlm7 <- interp(
x = controlm7$column_num,
y = controlm7$row_num,
z = controlm7$no_nymphs,
linear = F,
duplicate = "mean"
)
all_z_values <- c(intercropping7$z,
mix7$z,
controlw7$z,
controlm7$z)
# global_z_min <- min(all_z_values, na.rm = T)
global_z_min <- -.01
global_z_max <- max(all_z_values, na.rm = T)
filled.contour(intercropping7$x, intercropping7$y, intercropping7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "Aphids heatmap",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(mix7$x, mix7$y, mix7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "Aphids heatmap",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(controlw7$x, controlw7$y, controlw7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "controlw7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(controlm7$x, controlm7$y, controlm7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "controlm7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(intercropping7$x, intercropping7$y, intercropping7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "intercropping7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(mix7$x, mix7$y, mix7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "mix7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(controlw7$x, controlw7$y, controlw7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "controlw7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(controlm7$x, controlm7$y, controlm7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "controlm7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(intercropping7$x, intercropping7$y, intercropping7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "intercropping7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
global_z_max
filled.contour(intercropping7$x, intercropping7$y, intercropping7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "intercropping7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(mix7$x, mix7$y, mix7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "mix7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(controlw7$x, controlw7$y, controlw7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "controlw7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
filled.contour(controlm7$x, controlm7$y, controlm7$z,
color.palette = colorRampPalette(c("blue", "green", "yellow", "red")), # Custom color palette
main = "controlm7",
xlab = "Grid column", # Customize your axis label as needed
ylab = "Grid row", # Customize your axis label as needed
key.title = title(main = "# Aphids", cex.main = 1),
zlim = c(global_z_min, global_z_max))
